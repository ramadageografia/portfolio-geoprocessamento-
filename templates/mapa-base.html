<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa Interativo - Portfólio</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        #map {
            height: 100vh;
            width: 100%;
        }
        
        .map-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            width: 300px;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .layer-control {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .legend {
            margin-top: 15px;
            padding: 10px;
            background: rgba(255,255,255,0.9);
            border-radius: 5px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            border: 1px solid #666;
        }
        
        .info-panel {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 1000;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            max-width: 400px;
        }
        
        .coordinates {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 8px 12px;
            border-radius: 5px;
            font-family: monospace;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    
    <!-- Painel de Controles -->
    <div class="map-controls">
        <h3><i class="fas fa-layer-group"></i> Camadas</h3>
        
        <!-- Controle de Basemaps -->
        <div class="layer-control">
            <h4>Mapa Base</h4>
            <select id="basemap-select" class="form-control">
                <option value="osm">OpenStreetMap</option>
                <option value="satellite">Satélite (ESRI)</option>
                <option value="topo">Topográfico</option>
                <option value="dark">Escuro</option>
            </select>
        </div>
        
        <!-- Camadas de Dados -->
        <div class="layer-control">
            <h4>Camadas de Dados</h4>
            <div class="checkbox-group">
                <label>
                    <input type="checkbox" id="layer-hydro" checked>
                    Hidrografia
                </label><br>
                <label>
                    <input type="checkbox" id="layer-roads" checked>
                    Rodovias
                </label><br>
                <label>
                    <input type="checkbox" id="layer-landuse">
                    Uso do Solo
                </label><br>
                <label>
                    <input type="checkbox" id="layer-points">
                    Pontos de Interesse
                </label>
            </div>
        </div>
        
        <!-- Legenda -->
        <div class="legend" id="dynamic-legend">
            <h4>Legenda</h4>
            <div class="legend-item">
                <div class="legend-color" style="background: #3388ff;"></div>
                <span>Hidrografia</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #ff3333;"></div>
                <span>Rodovias</span>
            </div>
        </div>
        
        <!-- Ferramentas -->
        <div class="tools" style="margin-top: 15px;">
            <button onclick="measureDistance()" class="btn">
                <i class="fas fa-ruler"></i> Medir Distância
            </button>
            <button onclick="measureArea()" class="btn">
                <i class="fas fa-draw-polygon"></i> Medir Área
            </button>
            <button onclick="printMap()" class="btn">
                <i class="fas fa-print"></i> Exportar Mapa
            </button>
        </div>
    </div>
    
    <!-- Painel de Informações -->
    <div class="info-panel">
        <h3><i class="fas fa-info-circle"></i> Sobre este Mapa</h3>
        <p>Mapa interativo desenvolvido com Leaflet.js</p>
        <p><strong>Dados:</strong> IBGE, OpenStreetMap, NASA SRTM</p>
        <p><strong>Projeto:</strong> [Nome do Projeto]</p>
        <a href="../projetos/[projeto].html" class="btn">
            <i class="fas fa-external-link-alt"></i> Ver Projeto Completo
        </a>
    </div>
    
    <!-- Coordenadas -->
    <div class="coordinates" id="coordinates">
        Lat: 0.0000, Lon: 0.0000
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-measure@3.1.0/dist/leaflet-measure.js"></script>
    <script>
        // Inicializar mapa
        const map = L.map('map').setView([-15.793889, -47.882778], 6);
        
        // Camadas base
        const basemaps = {
            osm: L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap'
            }),
            satellite: L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                attribution: '© Esri'
            }),
            topo: L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenTopoMap'
            }),
            dark: L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                attribution: '© CARTO'
            })
        };
        
        // Adicionar camada base padrão
        basemaps.osm.addTo(map);
        
        // Controle de basemaps
        document.getElementById('basemap-select').addEventListener('change', function(e) {
            Object.values(basemaps).forEach(layer => map.removeLayer(layer));
            basemaps[e.target.value].addTo(map);
        });
        
        // Carregar dados GeoJSON (exemplo)
        const layers = {
            hydro: null,
            roads: null,
            landuse: null,
            points: null
        };
        
        // Função para carregar camadas
        function loadLayer(layerId, url, style, popupTemplate) {
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    layers[layerId] = L.geoJSON(data, {
                        style: style,
                        onEachFeature: function(feature, layer) {
                            if (popupTemplate && feature.properties) {
                                const content = popupTemplate(feature.properties);
                                layer.bindPopup(content);
                            }
                        }
                    }).addTo(map);
                });
        }
        
        // Controles de camadas
        document.getElementById('layer-hydro').addEventListener('change', function(e) {
            if (e.target.checked && !layers.hydro) {
                loadLayer('hydro', 'data/hidrografia.geojson', {
                    color: '#3388ff',
                    weight: 2,
                    opacity: 0.8
                }, props => `<strong>Rio:</strong> ${props.nome || 'Sem nome'}`);
            } else if (!e.target.checked && layers.hydro) {
                map.removeLayer(layers.hydro);
                layers.hydro = null;
            }
        });
        
        // Coordenadas em tempo real
        map.on('mousemove', function(e) {
            document.getElementById('coordinates').innerHTML = 
                `Lat: ${e.latlng.lat.toFixed(4)}, Lon: ${e.latlng.lng.toFixed(4)}`;
        });
        
        // Ferramenta de medição
        const measureControl = new L.Control.Measure({
            position: 'topleft',
            primaryLengthUnit: 'kilometers',
            secondaryLengthUnit: 'meters',
            primaryAreaUnit: 'sqkilometers',
            secondaryAreaUnit: 'hectares'
        });
        measureControl.addTo(map);
        
        // Funções personalizadas
        function measureDistance() {
            alert('Clique no mapa para iniciar medição de distância');
            // Implementação específica
        }
        
        function measureArea() {
            alert('Clique para medir área');
            // Implementação específica
        }
        
        function printMap() {
            window.print();
        }
        
        // Adicionar marcadores de exemplo
        L.marker([-15.793889, -47.882778])
            .addTo(map)
            .bindPopup('<strong>Brasília</strong><br>Capital do Brasil')
            .openPopup();
    </script>
</body>
</html>
